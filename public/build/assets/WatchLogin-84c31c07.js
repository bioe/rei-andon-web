import{l as u,v as S,c as B,w as m,o as d,a,u as e,X as U,b as t,n as _,f as W,g as A,h as v,d as w,F as y,i as M,e as $,m as b,O as I}from"./app-2d264a90.js";import{_ as O}from"./InputLabel-6539457d.js";import{_ as F,G}from"./GuestPrimaryButton-63d1b9c1.js";import{_ as C}from"./InputError-1906bc46.js";import{_ as k}from"./Alert-26f08fda.js";import{T as q}from"./vue3-treeselect.min-952aa39b.js";import"./_plugin-vue_export-helper-c27b6911.js";const z=t("h1",{class:"h3 mb-3 fw-normal"},"Andon Watch Login",-1),D=["onSubmit"],H=t("label",{for:"floatingUsername"},"Employee Code",-1),P=t("span",{class:"spinner-grow spinner-grow-sm","aria-hidden":"true"},null,-1),R=t("span",{role:"status"},"Connecting...",-1),X={class:"mt-4"},se={__name:"WatchLogin",props:{timeout_sec:{type:Number},watch_login_log_id:{type:Number},login_message:{type:String}},setup(x){const i=x,l=u(!1),g=u(i.login_message),c=u(""),s=S({watch_code:null,username:""}),L=()=>{l.value=!0,c.value="",g.value="",s.post(route("watch_login.main"),{onSuccess:n=>T(),onError:()=>l.value=!1})};let f=null,h=null;const T=()=>{f=setInterval(V,1e3,i.watch_login_log_id),h=setTimeout(()=>{p(),c.value="Unable to login, please try again."},i.timeout_sec)};function V(n){b.get(route("watch_login.is_login",n)).then(function(o){o.data.success&&(p(),s.reset(),I.visit(route("watch_login.main")))}).catch(function(){})}function p(){clearInterval(f),clearTimeout(h),l.value=!1}function E({action:n,searchQuery:o,callback:r}){n==="ASYNC_SEARCH"&&b.get(route("watch_login.available",{keyword:o})).then(function(N){r(null,N.data)})}return(n,o)=>(d(),B(F,null,{default:m(()=>[a(e(U),{title:"Watch Login"}),z,a(k,{message:g.value,status:"success"},null,8,["message"]),a(k,{message:c.value,status:"danger"},null,8,["message"]),t("form",{onSubmit:$(L,["prevent"])},[t("div",{class:_(["text-start",{"is-invalid":e(s).errors.watch_code}])},[a(O,{for:"watch",value:"Watch Code"}),a(e(q),{modelValue:e(s).watch_code,"onUpdate:modelValue":o[0]||(o[0]=r=>e(s).watch_code=r),async:!0,"load-options":E,placeholder:"Enter Watch Code"},null,8,["modelValue"])],2),a(C,{class:"my-1",message:e(s).errors.watch_code},null,8,["message"]),t("div",{class:_(["form-floating my-2",{"is-invalid":e(s).errors.username}])},[W(t("input",{type:"text",class:_(["form-control",{"is-invalid":e(s).errors.username}]),id:"floatingUsername","onUpdate:modelValue":o[1]||(o[1]=r=>e(s).username=r),placeholder:"Employee Code",required:"",autocomplete:"false"},null,2),[[A,e(s).username]]),H],2),a(C,{class:"my-1",message:e(s).errors.username},null,8,["message"]),a(G,{disabled:l.value},{default:m(()=>[l.value?(d(),v(y,{key:0},[P,R],64)):(d(),v(y,{key:1},[w(" Log in ")],64))]),_:1},8,["disabled"]),t("div",X,[a(e(M),{href:n.route("login")},{default:m(()=>[w(" Admin Login ")]),_:1},8,["href"])])],40,D)]),_:1}))}};export{se as default};
