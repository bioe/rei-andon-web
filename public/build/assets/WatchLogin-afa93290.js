import{l as d,v as W,c as B,w as i,o as _,a,u as e,X as U,b as t,n as f,f as A,g as M,h as w,d as c,F as b,i as y,e as $,m as C,O as I}from"./app-5e233097.js";import{_ as O}from"./InputLabel-c0a77240.js";import{_ as D,G as F}from"./GuestPrimaryButton-cc869018.js";import{_ as k}from"./InputError-e8acc2d8.js";import{_ as L}from"./Alert-0b709f48.js";import{T as G}from"./vue3-treeselect.min-7fb0e913.js";import"./_plugin-vue_export-helper-c27b6911.js";const q=t("h1",{class:"h3 mb-3 fw-normal"},"Andon Watch Login",-1),z=["onSubmit"],H=t("label",{for:"floatingUsername"},"Employee Code",-1),P=t("span",{class:"spinner-grow spinner-grow-sm","aria-hidden":"true"},null,-1),R=t("span",{role:"status"},"Connecting...",-1),X={class:"mt-4"},Y=t("br",null,null,-1),ae={__name:"WatchLogin",props:{timeout_sec:{type:Number},watch_login_log_id:{type:Number},login_message:{type:String}},setup(T){const u=T,l=d(!1),g=d(u.login_message),m=d(""),s=W({watch_code:null,username:""}),V=()=>{l.value=!0,m.value="",g.value="",s.post(route("watch_login.main"),{onSuccess:n=>x(),onError:()=>l.value=!1})};let h=null,p=null;const x=()=>{h=setInterval(E,1e3,u.watch_login_log_id),p=setTimeout(()=>{v(),m.value="Unable to login, please try again."},u.timeout_sec)};function E(n){C.get(route("watch_login.is_login",n)).then(function(o){o.data.success&&(v(),s.reset(),I.visit(route("watch_login.main")))}).catch(function(){})}function v(){clearInterval(h),clearTimeout(p),l.value=!1}function N({action:n,searchQuery:o,callback:r}){n==="ASYNC_SEARCH"&&C.get(route("watch_login.available",{keyword:o})).then(function(S){r(null,S.data)})}return(n,o)=>(_(),B(D,null,{default:i(()=>[a(e(U),{title:"Watch Login"}),q,a(L,{message:g.value,status:"success"},null,8,["message"]),a(L,{message:m.value,status:"danger"},null,8,["message"]),t("form",{onSubmit:$(V,["prevent"])},[t("div",{class:f(["text-start",{"is-invalid":e(s).errors.watch_code}])},[a(O,{for:"watch",value:"Watch Code"}),a(e(G),{modelValue:e(s).watch_code,"onUpdate:modelValue":o[0]||(o[0]=r=>e(s).watch_code=r),async:!0,"load-options":N,placeholder:"Enter Watch Code"},null,8,["modelValue"])],2),a(k,{class:"my-1",message:e(s).errors.watch_code},null,8,["message"]),t("div",{class:f(["form-floating my-2",{"is-invalid":e(s).errors.username}])},[A(t("input",{type:"text",class:f(["form-control",{"is-invalid":e(s).errors.username}]),id:"floatingUsername","onUpdate:modelValue":o[1]||(o[1]=r=>e(s).username=r),placeholder:"Employee Code",required:"",autocomplete:"false"},null,2),[[M,e(s).username]]),H],2),a(k,{class:"my-1",message:e(s).errors.username},null,8,["message"]),a(F,{disabled:l.value},{default:i(()=>[l.value?(_(),w(b,{key:0},[P,R],64)):(_(),w(b,{key:1},[c(" Log in ")],64))]),_:1},8,["disabled"]),t("div",X,[a(e(y),{href:n.route("login")},{default:i(()=>[c(" Admin Login ")]),_:1},8,["href"]),c(),Y,a(e(y),{href:n.route("watch_dashboard")},{default:i(()=>[c(" Watch Dashboard ")]),_:1},8,["href"])])],40,z)]),_:1}))}};export{ae as default};
